{"ts":1349717124219,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"function setupLayout(){\r\n\tif (configOptions.displayDescription == false && configOptions.displayLegend == false){\r\n\t\tdojo.style(dojo.byId(\"leftPane\"), \"display\", \"none\");\t\r\n\t}\r\n\telse if (configOptions.displayDescription == true && configOptions.displayLegend == false){\r\n\t\tdojo.style(dojo.byId(\"legendHeader\"), \"display\", \"none\");\r\n\t\tdojo.style(dojo.byId(\"legendPanel\"), \"display\", \"none\");\r\n\t\tdojo.style(dojo.byId(\"descriptionPanel\"), \"height\", \"100%\");\t\t\r\n\t}\r\n\telse if (configOptions.displayDescription == false && configOptions.displayLegend == true){\r\n\t\tdojo.style(dojo.byId(\"descriptionPanel\"), \"display\", \"none\");\r\n\t\tdojo.style(dojo.byId(\"legendHeader\"), \"display\", \"none\");\r\n\t\tdojo.style(dojo.byId(\"legendPanel\"), \"height\", \"100%\");\t\t\r\n\t}\r\n\telse{\r\n\t\tresetLayout();\r\n\t}\r\n}\r\n\r\nfunction addTabsAndTime(){\r\n\tif(configOptions.webmaps.length > 1 && timeInterface == true){\r\n\t\tdojo.style(dojo.byId(\"banner\"), \"height\", \"195px\");\r\n\t}\r\n\telse if(configOptions.webmaps.length == 1 && timeInterface == true){\r\n\t\tdojo.style(dojo.byId(\"banner\"), \"height\", \"150px\");\r\n\t}\r\n\telse if (configOptions.webmaps.length > 1 && timeInterface == false){\r\n\t\tdojo.style(dojo.byId(\"banner\"), \"height\", \"150px\");\r\n\t}\r\n\tdijit.byId(\"mainWindow\").layout();\r\n\tsetupLayout();\r\n}\r\n\r\nfunction resetLayout(){\r\n\tif (configOptions.displayDescription == true && configOptions.displayLegend == true){\r\n\t\tlegendHeight = dojo.style(dojo.byId(\"leftPane\"),\"height\") - dojo.style(dojo.byId(\"descriptionPanel\"),\"height\") - dojo.style(dojo.byId(\"legendHeader\"),\"height\")-10;\r\n\t\tif (dojo.isIE != null){\r\n\t\t\tlegendHeight = dojo.style(dojo.byId(\"leftPane\"),\"height\") - (dojo.style(dojo.byId(\"leftPane\"),\"height\")*0.45) - dojo.style(dojo.byId(\"legendHeader\"),\"height\");\r\n\t\t}\r\n\t\tdojo.style(dojo.byId(\"legendPanel\"),\"height\",legendHeight+\"px\");\r\n\t}\r\n\tdijit.byId(\"mainWindow\").layout();\r\n}\r\n\r\nfunction changeMap(index){\r\n\tif (mapsReady == true){\r\n\t\t\r\n\t\tstopTime();\r\n\t\t\r\n\t\tcm = index;\r\n\t\t\r\n\t\tvar currentMap = dojo.byId(\"mapDiv\"+cm);\r\n\t\t\r\n\t\tdojo.forEach(dojo.query(\".tab\"),function(node){\r\n\t\t\tdojo.removeClass(node,\"selected\");\r\n\t\t});\r\n\t\tdojo.addClass(dojo.byId(\"tab\"+cm),\"selected\");\r\n\t\tdojo.forEach(_maps,function(map,i){\r\n\t\t\tif(cm != i){\r\n\t\t\t\tdojo.fadeOut({\r\n\t\t\t\t\tnode: dojo.byId(\"mapDiv\"+i),\r\n\t\t\t\t\tduration: 500\r\n\t\t\t\t}).play();\r\n\t\t\t\tdojo.style(dojo.byId(\"legend\"+i),\"display\",\"none\");\r\n\t\t\t\tdojo.style(dojo.byId(\"title\"+i),\"display\",\"none\");\r\n\t\t\t\tdojo.style(dojo.byId(\"description\"+i),\"display\",\"none\");\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tdojo.fadeIn({\r\n\t\t\t\t\tnode: dojo.byId(\"mapDiv\"+i),\r\n\t\t\t\t\tduration: 500\r\n\t\t\t\t}).play();\r\n\t\t\t\tdojo.style(dojo.byId(\"legend\"+i),\"display\",\"block\");\r\n\t\t\t\tdojo.style(dojo.byId(\"title\"+i),\"display\",\"block\");\r\n\t\t\t\tdojo.style(dojo.byId(\"description\"+i),\"display\",\"block\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tdojo.place(currentMap,dojo.byId('mapPane'),'last');\r\n\t\tif (_timeProperties[cm] != null){\r\n\t\t\tif (_thumbIndexes[cm] != null){\r\n\t\t\t\ttimeSlider.setThumbIndexes(_thumbIndexes[cm]);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\ttimeSlider.setThumbIndexes([0,1]);\r\n\t\t\t}\r\n\t\t\tif(dojo.byId(\"timeSliderBlind\")){\r\n\t\t\t\tdojo.fadeOut({\r\n\t\t\t\t\tnode: dojo.byId(\"timeSliderBlind\"),\r\n\t\t\t\t\tduration: 500\r\n\t\t\t\t}).play();\r\n\t\t\t\tvar t = setTimeout(\"dojo.style(dojo.byId('timeSliderBlind'),'display','none')\",500);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdojo.fadeIn({\r\n\t\t\t\tnode: dojo.byId(\"timeDisplay\"),\r\n\t\t\t\tduration: 500\r\n\t\t\t}).play();\r\n\t\t\tdojo.style(dojo.byId('timeDisplay'),'z-index','100');\r\n\t\t\t\t\t\t\r\n\t\t\tvar startTime = _timeProperties[cm].startTime;\r\n\t\t\tvar endTime = _timeProperties[cm].endTime;\r\n\t\t    var fullTimeExtent = new esri.TimeExtent(new Date(startTime), new Date(endTime));\r\n\t\t\t\r\n\t\t\ttimeSlider.setThumbCount(_timeProperties[cm].thumbCount);\r\n\t\t    timeSlider.setThumbMovingRate(_timeProperties[cm].thumbMovingRate);\r\n\t\t\t\r\n\t\t\tif(_timeProperties[cm].numberOfStops){\r\n\t\t\t\ttimeSlider.createTimeStopsByCount(fullTimeExtent,_timeProperties[cm].numberOfStops);\r\n\t\t  \t}\r\n\t\t\telse{\r\n\t\t\t\ttimeSlider.createTimeStopsByTimeInterval(fullTimeExtent,_timeProperties[cm].timeStopInterval.interval,_timeProperties[cm].timeStopInterval.units);\r\n\t\t  \t}\r\n\t\t\t\r\n\t\t\ttimeSlider.setTickCount(timeSlider.timeStops.length);\r\n\t\t\t\r\n\t\t\tdojo.forEach(_maps, function(map,i){\r\n\t\t\t\tif (_timeProperties[i] != null){\r\n\t\t\t\t\tif (cm != i){\r\n\t\t\t\t\t\tmap.setTimeSlider();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tmap.setTimeSlider(timeSlider);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tcenterTimeDisplay();\t\t\t\r\n\t\t}\r\n\t\telse{\r\n\t\t\tdojo.fadeOut({\r\n\t\t\t\tnode: dojo.byId(\"timeDisplay\"),\r\n\t\t\t\tduration: 500\r\n\t\t\t}).play();\r\n\t\t\tvar t = setTimeout(\"dojo.style(dojo.byId('timeDisplay'),'z-index','0')\",500);\r\n\t\t\tif(dojo.byId(\"timeSliderBlind\")){\r\n\t\t\t\tdojo.style(dojo.byId(\"timeSliderBlind\"),\"display\",\"block\");\r\n\t\t\t\tvar fadeto = {\r\n\t\t\t\t\tnode: dojo.byId(\"timeSliderBlind\"),\r\n\t\t\t\t\tduration: 500,\r\n\t\t\t\t\tonAnimate: function(o){\r\n\t\t\t\t\t\tif(o.opacity >= 0.75){\r\n\t\t\t\t\t\t\tfade.stop();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar fade = dojo.fadeIn(fadeto).play();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction centerTimeDisplay(){\r\n\tvar timeDiv = dojo.position('timeDisplay', true);\r\n\tvar mapDiv = dojo.position('mapPane', true);\r\n\tvar posLeft = (mapDiv.w/2) - (timeDiv.w/2);\r\n\tdojo.style(dojo.byId(\"timeDisplay\"),\"left\",posLeft+\"px\");\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":5120}]],"length":5120}
